{"version":3,"file":"input-scan-reader.js","sourceRoot":"","sources":["../../../src/components/input-scan-reader/input-scan-reader.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Event, Method, Element, EventEmitter, State, Listen, Prop } from '@stencil/core';\n\n\n\n\n\n// DNI EXAMPLES\n// \"17572896    \"A\"1\"CABRA\"LEONARDO ANTONIO FABIO\"ARGENTINA\"26-08-1965\"M\"08-08-2011\"00057696015\"5    \"08-08-2026\"31\"0\"ILRÑ2.01 CÑ110613.02 )No Cap.=\"UNIDAD ·05 ÇÇ S-NÑ 0040:2008::0005\n// 00691556286\"CANO\"JONATHAN LEONARDO\"M\"33951134\"C\"08-08-1988\"17-07-2022\"239\n// 00395738312\"TASSISTRO\"FLORENCIA ANTONELLA\"F\"41195367\"A\"20-06-1998\"30-08-2015\"275\n// 00115714043\"PIUMATO\"ANDRES JUAN\"M\"38305357\"B\"04-05-1994\"05-06-2012\n\n\n\n@Component({\n  tag: 'input-scan-reader',\n  styleUrl: 'input-scan-reader.css',\n  shadow: true,\n})\nexport class InputScanReader {\n\n  @Element() el: HTMLElement;\n  \n  @Prop() modalTimer?: number = 500;\n\n  @Listen('scan')\n  handleScan(event: CustomEvent<InputScanData>) {\n    if ( this.modalTimer == 0 ) {\n      return;\n    }\n\n    // crear un elemento tipo DIV del tamaño del parentNode de this.el\n\n    const parent = this.el.parentNode;\n\n    const div = document.createElement('div');\n    div.style.position = 'fixed';\n    div.style.top = '0';\n    div.style.left = '0';\n    div.style.width = '100vw';\n    div.style.height = '100vh';\n    div.style.backgroundColor = 'rgba(254,254,254,0.65)';\n    div.style.zIndex = '1000';\n    div.style.display = 'flex';\n    div.style.alignItems = 'center';\n    div.style.justifyContent = 'center';\n    div.style.color = 'black';\n    div.style.fontSize = '3rem';\n    div.style.fontWeight = 'bold';\n    div.style.textAlign = 'center';\n    div.style.padding = '1rem';\n    div.style.boxSizing = 'border-box';\n    div.style.borderRadius = '1rem';\n    div.style.overflow = 'hidden';\n    div.style.textOverflow = 'ellipsis';\n    div.style.whiteSpace = 'nowrap';\n    div.style.cursor = 'pointer';\n    div.textContent = event.detail.text;\n    div.addEventListener('click', () => {\n      div.remove();\n    }\n    )\n    parent.appendChild(div);\n    setTimeout(() => {\n      div.remove();\n    }\n    , this.modalTimer);\n\n\n\n    \n  }\n\n  processText(text: string): InputScanData {\n    const scannedData = this.runRegex( text )\n\n    let data;\n    if ( scannedData ) {\n      data = scannedData;\n    } else {\n      data = {\n        type: InputScanType.DESCONOCIDO,\n        text: this.scannedText,\n        data:  {\n          text: this.scannedText,\n        }\n      }\n    }\n\n    return data;\n  }\n\n  onEnterHandler() {\n    if ( this.scannedText == '' ) {\n      return false;\n    }\n\n    // convierto el texto a InputScanData\n    const scannedData = this.processText(this.scannedText)\n    \n    // reinicializo texto\n    this.scannedText = '';\n\n    // emit the scanned data and reset the scannedText\n    this.scan.emit(scannedData);\n  }\n\n\n  @Listen('keydown', { target: 'document' })\n  handleKeyDown(event: KeyboardEvent) {\n      if (event.isComposing ) {\n        return;\n      }\n\n      if(event.code == 'Enter') {\n        return this.onEnterHandler();\n      } \n\n      if ( event.key == 'Shift' || event.key == 'Control' || event.key == 'Alt' || event.key == 'Meta' ) {\n        return;\n      }\n      \n      // write the string of the event to the scannedText only if it is a letter or a number\n      this.scannedText += event.key;\n  }\n\n\n  @State() scannedText = '';\n\n  @Event() scan: EventEmitter<InputScanData>;\n\n\n  @Method()\n  async getText(): Promise<string> {\n    return this.scannedText\n  }\n\n  @Method()\n  async getData(): Promise<InputScanData> {\n    if ( this.scannedText == '' ) {\n      return null;\n    }\n\n    return this.processText(this.scannedText)\n  }\n\n\n  runRegex( text:string): InputScanData {\n    let regex,regrun\n      // DNI v1\n      // \"30368326    \"A\"1\"VILAR\"ALEJANDRO ERNESTO\"ARGENTINA\"07-06-1983\"M\"13-02-2011\"00038329892\"7019 \"13-02-2026\"616\"0\"ILRÑ2.01 CÑ110128.02 )No Cap.=\"UNIDADÑ DG200 Plus ÇÇ SERIE NMEROÑ ¡040:2009::0019\"\n      regex = /^\\\"?(\\w{8}) +\\\"?([a-z])\\\"?(\\w)\\\"?([a-z ]+)\\\"?([a-z ]+)\\\"?([a-z]+)\\\"?([0-9-]+)\\\"?([a-z])\"/gi\n      regrun = regex.exec( text )\n      if ( regrun ) {\n        return this.getDataFromDNIv1(regrun,  text );\n        \n      }\n\n      // DNI v2\n      regex = /^\\\"?(\\d+)\\\"?([a-z ]+)\\\"?([a-z ]+)\\\"?([a-z])\\\"?(\\w{8})\\\"?([a-z])\\\"?([0-9-]+)/gi\n      regrun = regex.exec( text )\n      if ( regrun ) {\n        return this.getDataFromDNIv2(regrun,  text );\n      }\n\n\n      // Licencia de conducir\n      regex = /^\\\"?(\\w{8})\\\"?([a-z])\\\"?([a-z ]+)\\\"?([a-z ]+)\\\"?([a-z]+)\\\"?([0-9-]+)\\\"?([a-z])\\\"?([0-9-]+)/gi\n      regrun = regex.exec( text )\n      if ( regrun ) {\n        return this.getDataFromLicenciaDeCOnducir(regrun,  text );\n      }\n\n\n      // email\n      regex = /^([a-z0-9_\\.-]+)@([\\da-z\\.-]+)\\.([a-z\\.]{2,6})$/gi\n      regrun = regex.exec( text )\n      if ( regrun ) {\n        return this.getDataFromMail(regrun,  text );\n      \n      }\n      // url\n      regex = /^(https?:\\/\\/)?([\\da-z\\.-]+)\\.([a-z\\.]{2,6})([\\/\\w \\.-]*)*\\/?$/gi\n      regrun = regex.exec( text )\n      if ( regrun ) {\n        return this.getDataFromURL(regrun,  text );\n      }\n  }\n\n\n  getDataFromDNIv1 (inputScanner: RegExpExecArray, scannedText: string): InputScanData {\n\n    return {\n      type: InputScanType.DNIv1,\n      text: scannedText,\n      data:  {\n        apellido: inputScanner[4],\n        nombre: inputScanner[5],\n        dni: inputScanner[1],\n        fecha_nacimiento: inputScanner[6],\n        sexo: inputScanner[7],\n      }\n    }\n  }\n\n\n  getDataFromDNIv2 (inputScanner: RegExpExecArray, scannedText: string): InputScanData {\n       \n    return {\n      type: InputScanType.DNIv2,\n      text: scannedText,\n      data:  {\n        apellido: inputScanner[2],\n        nombre: inputScanner[3],\n        dni: inputScanner[5],\n        fecha_nacimiento: inputScanner[7],\n        sexo: inputScanner[4],\n      }\n    }\n  }\n\n\n  getDataFromMail (inputScanner: RegExpExecArray, scannedText: string): InputScanData {\n       \n    return {\n      type: InputScanType.EMAIL,\n      text: scannedText,\n      data:  {\n        email: inputScanner[1],\n      }\n    }\n  }\n\n  getDataFromURL (inputScanner: RegExpExecArray, scannedText: string): InputScanData {\n\n    return {\n      type: InputScanType.URL,\n      text: scannedText,\n      data:  {\n        url: inputScanner[1],\n      }\n    }\n  }\n\n  getDataFromLicenciaDeCOnducir (inputScanner: RegExpExecArray, scannedText: string): InputScanData {\n       \n    return {\n      type: InputScanType.DNIv1,\n      text: scannedText,\n      data:  {\n        nosequeva: inputScanner[1],\n      }\n    }\n  }\n\n  handleOnInpujtChangeEvent(ev: Event) {\n    this.scannedText = (ev.target as HTMLInputElement).value;\n  }\n\n\n  render() {\n    return (\n      <Host>\n        <input type=\"text\" value={this.scannedText} onChange={(ev) => this.handleOnInpujtChangeEvent(ev) }/>\n      </Host>\n    );\n  }\n\n}\n"]}