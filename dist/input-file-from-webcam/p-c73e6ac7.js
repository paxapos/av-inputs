import{W as e,C as t,a,b as i}from"./p-628cdf12.js";import"./p-b64684d5.js";class o extends e{async getPhoto(e){return new Promise((async(a,i)=>{if(e.webUseInput||e.source===t.Photos){this.fileInputExperience(e,a)}else if(e.source===t.Prompt){let t=document.querySelector("pwa-action-sheet");if(!t){t=document.createElement("pwa-action-sheet");document.body.appendChild(t)}t.header=e.promptLabelHeader||"Photo";t.cancelable=false;t.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}];t.addEventListener("onSelection",(async t=>{const o=t.detail;if(o===0){this.fileInputExperience(e,a)}else{this.cameraExperience(e,a,i)}}))}else{this.cameraExperience(e,a,i)}}))}async pickImages(e){return new Promise((async e=>{this.multipleFileInputExperience(e)}))}async cameraExperience(e,t,o){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===a.Front?"user":"environment";document.body.appendChild(s);try{await s.componentOnReady();s.addEventListener("onPhoto",(async a=>{const n=a.detail;if(n===null){o(new i("User cancelled photos app"))}else if(n instanceof Error){o(n)}else{t(await this._getCameraPhoto(n,e))}s.dismiss();document.body.removeChild(s)}));s.present()}catch(a){this.fileInputExperience(e,t)}}else{console.error(`Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements.`);this.fileInputExperience(e,t)}}fileInputExperience(e,i){let o=document.querySelector("#_capacitor-camera-input");const s=()=>{var e;(e=o.parentNode)===null||e===void 0?void 0:e.removeChild(o)};if(!o){o=document.createElement("input");o.id="_capacitor-camera-input";o.type="file";o.hidden=true;document.body.appendChild(o);o.addEventListener("change",(t=>{const a=o.files[0];let n="jpeg";if(a.type==="image/png"){n="png"}else if(a.type==="image/gif"){n="gif"}if(e.resultType==="dataUrl"||e.resultType==="base64"){const t=new FileReader;t.addEventListener("load",(()=>{if(e.resultType==="dataUrl"){i({dataUrl:t.result,format:n})}else if(e.resultType==="base64"){const e=t.result.split(",")[1];i({base64String:e,format:n})}s()}));t.readAsDataURL(a)}else{i({webPath:URL.createObjectURL(a),format:n});s()}}))}o.accept="image/*";o.capture=true;if(e.source===t.Photos||e.source===t.Prompt){o.removeAttribute("capture")}else if(e.direction===a.Front){o.capture="user"}else if(e.direction===a.Rear){o.capture="environment"}o.click()}multipleFileInputExperience(e){let t=document.querySelector("#_capacitor-camera-input-multiple");const a=()=>{var e;(e=t.parentNode)===null||e===void 0?void 0:e.removeChild(t)};if(!t){t=document.createElement("input");t.id="_capacitor-camera-input-multiple";t.type="file";t.hidden=true;t.multiple=true;document.body.appendChild(t);t.addEventListener("change",(i=>{const o=[];for(let e=0;e<t.files.length;e++){const a=t.files[e];let i="jpeg";if(a.type==="image/png"){i="png"}else if(a.type==="image/gif"){i="gif"}o.push({webPath:URL.createObjectURL(a),format:i})}e({photos:o});a()}))}t.accept="image/*";t.click()}_getCameraPhoto(e,t){return new Promise(((a,i)=>{const o=new FileReader;const s=e.type.split("/")[1];if(t.resultType==="uri"){a({webPath:URL.createObjectURL(e),format:s,saved:false})}else{o.readAsDataURL(e);o.onloadend=()=>{const e=o.result;if(t.resultType==="dataUrl"){a({dataUrl:e,format:s,saved:false})}else{a({base64String:e.split(",")[1],format:s,saved:false})}};o.onerror=e=>{i(e)}}}))}async checkPermissions(){if(typeof navigator==="undefined"||!navigator.permissions){throw this.unavailable("Permissions API not available in this browser")}try{const e=await window.navigator.permissions.query({name:"camera"});return{camera:e.state,photos:"granted"}}catch(e){throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const s=new o;export{s as Camera,o as CameraWeb};
//# sourceMappingURL=p-c73e6ac7.js.map