import{r as t,c as i,h as s,H as e,g as n}from"./p-b64684d5.js";var a;(function(t){t["Rear"]="REAR";t["Front"]="FRONT"})(a||(a={}));class h{constructor(){}async initCamera(t,i,s=null){this.resetCamera();const e=t.getElementsByTagName("video");if(e.length==0){this.elVideo=document.createElement("video");this.elVideo.autoplay=true;this.elVideo.style.display="none";t.appendChild(this.elVideo)}else{this.elVideo=e[0]}const n=t.getElementsByTagName("canvas");if(n.length===0){this.canvas=document.createElement("canvas");this.canvas.width=parseInt(t.getAttribute("width"));this.canvas.height=parseInt(t.getAttribute("height"));t.appendChild(this.canvas)}else{this.canvas=n[0]}this.direction=a.Front;if(navigator.mediaDevices.getUserMedia){console.info("la camara");const t=i==a.Front?"user":"environment";navigator.mediaDevices.getUserMedia({audio:false,video:{width:{min:200},height:{min:200},facingMode:t}}).then((t=>{this.stream=t;console.info("la camara",this.stream);this.elVideo.srcObject=this.stream;this.renderToCanvas(s)})).catch((function(t){console.log("Something went wrong!",t)}))}}renderToCanvas(t=null){let i=this.canvas.getContext("2d");let s=this.elVideo.videoWidth;let e=this.elVideo.videoHeight;var n=Math.min(s,e);var a=(s-n)/2;var h=(e-n)/2;if(typeof t=="function"){t.call(i,this.elVideo,a,h,n,n,0,0,this.canvas.width,this.canvas.height)}else{i.drawImage(this.elVideo,a,h,n,n,0,0,this.canvas.width,this.canvas.height)}requestAnimationFrame((()=>this.renderToCanvas()))}resetCamera(){var t,i;if(this.stream)(i=(t=this.stream)===null||t===void 0?void 0:t.getVideoTracks())===null||i===void 0?void 0:i.forEach((t=>{var i;t===null||t===void 0?void 0:t.stop();(i=this.stream)===null||i===void 0?void 0:i.removeTrack(t)}));if(this.elVideo)this.elVideo.srcObject=null}async takePicture(){return new Promise(((t,i)=>{try{this.canvas.toBlob((i=>{const s="pic_"+Math.abs(Math.round(Math.random()*1e3));var e=new File([i],s,{type:"image/jpeg"});t(e)}),"image/jpeg",.8)}catch(t){i(t)}}))}}class o{constructor(){this.camaraManager=new h}async initCamera(t,i,s=null){this.camaraManager.initCamera(t,i,s)}async takePicture(){return await this.camaraManager.takePicture()}async resetCamera(){return await this.camaraManager.resetCamera()}}const r=new o;const c=":host{display:inline-block;width:100px;filter:drop-shadow(2px 4px 6px black);border:#5a5252 1px solid;border-style:groove}video{display:none}canvas{width:100%;height:100%}";const l=class{constructor(s){t(this,s);this.pictureTaken=i(this,"pictureTaken",6);this.facingModeChanged=i(this,"facingModeChanged",6);this.width=460;this.height=460;this.facingMode=a.Front;this.drawImageCb=null}async takePic(){const t=await r.takePicture();this.pictureTaken.emit(t);return t}async resetCamera(){r.resetCamera()}async toggleCamera(){this.__toogleFacingMode()}onClickHandler(){this.__toogleFacingMode()}__toogleFacingMode(){this.facingMode=this.facingMode!=a.Front?a.Front:a.Rear;this.facingModeChanged.emit(this.facingMode)}componentWillMount(){}async componentDidRender(){r.initCamera(this.el,a.Front,this.drawImageCb)}async disconnectedCallback(){r.resetCamera()}render(){return s(e,{style:{height:this.height+"px",width:this.width+"px"}},s("slot",{name:"before"}),s("slot",null),s("slot",{name:"after"}))}get el(){return n(this)}};l.style=c;export{l as input_file_from_webcam};
//# sourceMappingURL=p-b8b2cbc4.entry.js.map