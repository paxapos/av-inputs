import{r as t,c as e,h as n,H as s}from"./p-5e58f578.js";
/*! Capacitor: https://capacitorjs.com/ - MIT License */var o;(function(t){t["Unimplemented"]="UNIMPLEMENTED";t["Unavailable"]="UNAVAILABLE"})(o||(o={}));class i extends Error{constructor(t,e,n){super(t);this.message=t;this.code=e;this.data=n}}const r=t=>{var e,n;if(t===null||t===void 0?void 0:t.androidBridge){return"android"}else if((n=(e=t===null||t===void 0?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0?void 0:n.bridge){return"ios"}else{return"web"}};const a=t=>{var e,n,s,a,c;const l=t.CapacitorCustomPlatform||null;const d=t.Capacitor||{};const u=d.Plugins=d.Plugins||{};const h=t.CapacitorPlatforms;const v=()=>l!==null?l.name:r(t);const f=((e=h===null||h===void 0?void 0:h.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||v;const p=()=>f()!=="web";const m=((n=h===null||h===void 0?void 0:h.currentPlatform)===null||n===void 0?void 0:n.isNativePlatform)||p;const w=t=>{const e=j.get(t);if(e===null||e===void 0?void 0:e.platforms.has(f())){return true}if(g(t)){return true}return false};const y=((s=h===null||h===void 0?void 0:h.currentPlatform)===null||s===void 0?void 0:s.isPluginAvailable)||w;const b=t=>{var e;return(e=d.PluginHeaders)===null||e===void 0?void 0:e.find((e=>e.name===t))};const g=((a=h===null||h===void 0?void 0:h.currentPlatform)===null||a===void 0?void 0:a.getPluginHeader)||b;const C=e=>t.console.error(e);const O=(t,e,n)=>Promise.reject(`${n} does not have an implementation of "${e}".`);const j=new Map;const $=(t,e={})=>{const n=j.get(t);if(n){console.warn(`Capacitor plugin "${t}" already registered. Cannot register plugins twice.`);return n.proxy}const s=f();const r=g(t);let a;const c=async()=>{if(!a&&s in e){a=typeof e[s]==="function"?a=await e[s]():a=e[s]}else if(l!==null&&!a&&"web"in e){a=typeof e["web"]==="function"?a=await e["web"]():a=e["web"]}return a};const h=(e,n)=>{var a,c;if(r){const s=r===null||r===void 0?void 0:r.methods.find((t=>n===t.name));if(s){if(s.rtype==="promise"){return e=>d.nativePromise(t,n.toString(),e)}else{return(e,s)=>d.nativeCallback(t,n.toString(),e,s)}}else if(e){return(a=e[n])===null||a===void 0?void 0:a.bind(e)}}else if(e){return(c=e[n])===null||c===void 0?void 0:c.bind(e)}else{throw new i(`"${t}" plugin is not implemented on ${s}`,o.Unimplemented)}};const v=e=>{let n;const r=(...r)=>{const a=c().then((a=>{const c=h(a,e);if(c){const t=c(...r);n=t===null||t===void 0?void 0:t.remove;return t}else{throw new i(`"${t}.${e}()" is not implemented on ${s}`,o.Unimplemented)}}));if(e==="addListener"){a.remove=async()=>n()}return a};r.toString=()=>`${e.toString()}() { [capacitor code] }`;Object.defineProperty(r,"name",{value:e,writable:false,configurable:false});return r};const p=v("addListener");const m=v("removeListener");const w=(t,e)=>{const n=p({eventName:t},e);const s=async()=>{const s=await n;m({eventName:t,callbackId:s},e)};const o=new Promise((t=>n.then((()=>t({remove:s})))));o.remove=async()=>{console.warn(`Using addListener() without 'await' is deprecated.`);await s()};return o};const y=new Proxy({},{get(t,e){switch(e){case"$$typeof":return undefined;case"toJSON":return()=>({});case"addListener":return r?w:p;case"removeListener":return m;default:return v(e)}}});u[t]=y;j.set(t,{name:t,proxy:y,platforms:new Set([...Object.keys(e),...r?[s]:[]])});return y};const P=((c=h===null||h===void 0?void 0:h.currentPlatform)===null||c===void 0?void 0:c.registerPlugin)||$;if(!d.convertFileSrc){d.convertFileSrc=t=>t}d.getPlatform=f;d.handleError=C;d.isNativePlatform=m;d.isPluginAvailable=y;d.pluginMethodNoop=O;d.registerPlugin=P;d.Exception=i;d.DEBUG=!!d.DEBUG;d.isLoggingEnabled=!!d.isLoggingEnabled;d.platform=d.getPlatform();d.isNative=d.isNativePlatform();return d};const c=t=>t.Capacitor=a(t);const l=c(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{});const d=l.registerPlugin;class u{constructor(t){this.listeners={};this.windowListeners={};if(t){console.warn(`Capacitor WebPlugin "${t.name}" config object was deprecated in v3 and will be removed in v4.`);this.config=t}}addListener(t,e){const n=this.listeners[t];if(!n){this.listeners[t]=[]}this.listeners[t].push(e);const s=this.windowListeners[t];if(s&&!s.registered){this.addWindowListener(s)}const o=async()=>this.removeListener(t,e);const i=Promise.resolve({remove:o});Object.defineProperty(i,"remove",{value:async()=>{console.warn(`Using addListener() without 'await' is deprecated.`);await o()}});return i}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners){this.removeWindowListener(this.windowListeners[t])}this.windowListeners={}}notifyListeners(t,e){const n=this.listeners[t];if(n){n.forEach((t=>t(e)))}}hasListeners(t){return!!this.listeners[t].length}registerWindowListener(t,e){this.windowListeners[e]={registered:false,windowEventName:t,pluginEventName:e,handler:t=>{this.notifyListeners(e,t)}}}unimplemented(t="not implemented"){return new l.Exception(t,o.Unimplemented)}unavailable(t="not available"){return new l.Exception(t,o.Unavailable)}async removeListener(t,e){const n=this.listeners[t];if(!n){return}const s=n.indexOf(e);this.listeners[t].splice(s,1);if(!this.listeners[t].length){this.removeWindowListener(this.windowListeners[t])}}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler);t.registered=true}removeWindowListener(t){if(!t){return}window.removeEventListener(t.windowEventName,t.handler);t.registered=false}}const h=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);const v=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class f extends u{async getCookies(){const t=document.cookie;const e={};t.split(";").forEach((t=>{if(t.length<=0)return;let[n,s]=t.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=v(n).trim();s=v(s).trim();e[n]=s}));return e}async setCookie(t){try{const e=h(t.key);const n=h(t.value);const s=`; expires=${(t.expires||"").replace("expires=","")}`;const o=(t.path||"/").replace("path=","");const i=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${e}=${n||""}${s}; path=${o}; ${i};`}catch(t){return Promise.reject(t)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const e of t){document.cookie=e.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}d("CapacitorCookies",{web:()=>new f});const p=async t=>new Promise(((e,n)=>{const s=new FileReader;s.onload=()=>{const t=s.result;e(t.indexOf(",")>=0?t.split(",")[1]:t)};s.onerror=t=>n(t);s.readAsDataURL(t)}));const m=(t={})=>{const e=Object.keys(t);const n=Object.keys(t).map((t=>t.toLocaleLowerCase()));const s=n.reduce(((n,s,o)=>{n[s]=t[e[o]];return n}),{});return s};const w=(t,e=true)=>{if(!t)return null;const n=Object.entries(t).reduce(((t,n)=>{const[s,o]=n;let i;let r;if(Array.isArray(o)){r="";o.forEach((t=>{i=e?encodeURIComponent(t):t;r+=`${s}=${i}&`}));r.slice(0,-1)}else{i=e?encodeURIComponent(o):o;r=`${s}=${i}`}return`${t}&${r}`}),"");return n.substr(1)};const y=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e);const s=m(t.headers);const o=s["content-type"]||"";if(typeof t.data==="string"){n.body=t.data}else if(o.includes("application/x-www-form-urlencoded")){const e=new URLSearchParams;for(const[n,s]of Object.entries(t.data||{})){e.set(n,s)}n.body=e.toString()}else if(o.includes("multipart/form-data")){const e=new FormData;if(t.data instanceof FormData){t.data.forEach(((t,n)=>{e.append(n,t)}))}else{for(const n of Object.keys(t.data)){e.append(n,t.data[n])}}n.body=e;const s=new Headers(n.headers);s.delete("content-type");n.headers=s}else if(o.includes("application/json")||typeof t.data==="object"){n.body=JSON.stringify(t.data)}return n};class b extends u{async request(t){const e=y(t,t.webFetchExtra);const n=w(t.params,t.shouldEncodeUrlParams);const s=n?`${t.url}?${n}`:t.url;const o=await fetch(s,e);const i=o.headers.get("content-type")||"";let{responseType:r="text"}=o.ok?t:{};if(i.includes("application/json")){r="json"}let a;let c;switch(r){case"arraybuffer":case"blob":c=await o.blob();a=await p(c);break;case"json":a=await o.json();break;case"document":case"text":default:a=await o.text()}const l={};o.headers.forEach(((t,e)=>{l[e]=t}));return{data:a,headers:l,status:o.status,url:o.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}d("CapacitorHttp",{web:()=>new b});var g;(function(t){t["Prompt"]="PROMPT";t["Camera"]="CAMERA";t["Photos"]="PHOTOS"})(g||(g={}));var C;(function(t){t["Rear"]="REAR";t["Front"]="FRONT"})(C||(C={}));var O;(function(t){t["Uri"]="uri";t["Base64"]="base64";t["DataUrl"]="dataUrl"})(O||(O={}));const j=d("Camera",{web:()=>import("./p-dfbbe9b5.js").then((t=>new t.CameraWeb))});class ${constructor(){}async capacitorTakePicture(){const t=await j.getPhoto({quality:90,allowEditing:true,resultType:O.Base64});return t}async initCamera(t,e,n={exact:"user"},s=null){var o;console.info(await this.capacitorTakePicture());this.resetCamera();this.elVideo=t;this.canvas=e;this.elVideo.parentNode.insertBefore(this.canvas,this.elVideo.nextSibling);if((o=navigator===null||navigator===void 0?void 0:navigator.mediaDevices)===null||o===void 0?void 0:o.getUserMedia){navigator.mediaDevices.getUserMedia({audio:false,video:{width:{min:200},height:{min:200},facingMode:n}}).then((t=>{this.stream=t;this.elVideo.srcObject=this.stream;this.renderToCanvas(s)})).catch((function(t){console.log("Something went wrong!",t)}))}}renderToCanvas(t=null){let e=this.canvas.getContext("2d");let n=this.elVideo.videoWidth;let s=this.elVideo.videoHeight;var o=Math.min(n,s);var i=(n-o)/2;var r=(s-o)/2;if(typeof t=="function"){t.call(e,this.elVideo,i,r,o,o,0,0,this.canvas.width,this.canvas.height)}else{e.drawImage(this.elVideo,i,r,o,o,0,0,this.canvas.width,this.canvas.height)}requestAnimationFrame((()=>this.renderToCanvas()))}resetCamera(){var t,e;if(this.stream)(e=(t=this.stream)===null||t===void 0?void 0:t.getVideoTracks())===null||e===void 0?void 0:e.forEach((t=>{var e;t===null||t===void 0?void 0:t.stop();(e=this.stream)===null||e===void 0?void 0:e.removeTrack(t)}));if(this.elVideo)this.elVideo.srcObject=null}async takePic(){return new Promise(((t,e)=>{try{this.canvas.toBlob((e=>{const n="pic_"+Math.abs(Math.round(Math.random()*1e3));var s=new File([e],n,{type:"image/jpeg"});t(s)}),"image/jpeg",.8)}catch(t){e(t)}}))}}const P=new $;const L=":host{display:inline-block;width:100px;filter:drop-shadow(2px 4px 6px black);border:#5a5252 1px solid;border-style:groove}video{display:none}canvas{width:100%;height:100%}";const x=class{constructor(n){t(this,n);this.pictureTaken=e(this,"pictureTaken",6);this.facingModeChanged=e(this,"facingModeChanged",6);this.width=460;this.height=460;this.facingMode="user";this.drawImageCb=null}async takePic(){const t=await P.takePic();this.pictureTaken.emit(t);return t}async toggleCamera(){this.__toogleFacingMode()}onClickHandler(){this.__toogleFacingMode()}__toogleFacingMode(){this.facingMode=this.facingMode!="user"?"user":"environment";this.facingModeChanged.emit(this.facingMode)}__createfacingModeConstrainDOMString(){return{ideal:this.facingMode}}componentWillMount(){}async componentDidRender(){P.initCamera(this.elVideo,this.elCanvas,this.__createfacingModeConstrainDOMString(),this.drawImageCb)}async disconnectedCallback(){P.resetCamera()}render(){return n(s,null,n("slot",{name:"before"}),n("video",{autoplay:"true",ref:t=>this.elVideo=t}),n("canvas",{ref:t=>this.elCanvas=t,width:this.width,height:this.height}),n("slot",null),n("slot",{name:"after"}))}};x.style=L;export{g as C,x as I,u as W,C as a,i as b};
//# sourceMappingURL=p-17671a99.js.map