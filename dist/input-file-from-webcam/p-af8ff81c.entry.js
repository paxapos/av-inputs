import{r as t,c as i,h as s,H as e,a}from"./p-61e4b3d7.js";import{c as n,a as o,C as h}from"./p-b8f7b4ac.js";class r{constructor(){}async initCamera(t,i,s=null){this.resetCamera();this.elVideo=n(t);this.canvas=o(t);this.direction=h.Front;if(navigator.mediaDevices.getUserMedia){console.info("la camara");const t=i==h.Front?"user":"environment";navigator.mediaDevices.getUserMedia({audio:false,video:{width:{min:200},height:{min:200},facingMode:t}}).then((t=>{this.stream=t;console.info("la camara",this.stream);this.elVideo.srcObject=this.stream;this.renderToCanvas(s)})).catch((function(t){console.log("Something went wrong!",t)}))}}renderToCanvas(t=null){let i=this.canvas.getContext("2d");let s=this.elVideo.videoWidth;let e=this.elVideo.videoHeight;var a=Math.min(s,e);var n=(s-a)/2;var o=(e-a)/2;if(typeof t=="function"){t.call(i,this.elVideo,n,o,a,a,0,0,this.canvas.width,this.canvas.height)}else{i.drawImage(this.elVideo,n,o,a,a,0,0,this.canvas.width,this.canvas.height)}requestAnimationFrame((()=>this.renderToCanvas()))}resetCamera(){var t,i;if(this.stream)(i=(t=this.stream)===null||t===void 0?void 0:t.getVideoTracks())===null||i===void 0?void 0:i.forEach((t=>{var i;t===null||t===void 0?void 0:t.stop();(i=this.stream)===null||i===void 0?void 0:i.removeTrack(t)}));if(this.elVideo)this.elVideo.srcObject=null}async takePicture(){return new Promise(((t,i)=>{try{this.canvas.toBlob((i=>{const s="pic_"+Math.abs(Math.round(Math.random()*1e3));var e=new File([i],s,{type:"image/jpeg"});t(e)}),"image/jpeg",.8)}catch(t){i(t)}}))}}class l{constructor(){this.camaraManager=new r}async initCamera(t,i,s=null){this.camaraManager.initCamera(t,i,s)}async takePicture(){return await this.camaraManager.takePicture()}async resetCamera(){return await this.camaraManager.resetCamera()}}const c=new l;const d=":host{display:inline-block;width:100px;filter:drop-shadow(2px 4px 6px black);border:#5a5252 1px solid;border-style:groove}video{display:none}canvas{width:100%;height:100%}";const u=class{constructor(s){t(this,s);this.pictureTaken=i(this,"pictureTaken",6);this.facingModeChanged=i(this,"facingModeChanged",6);this.width=460;this.height=460;this.facingMode=h.Front;this.drawImageCb=null}async takePic(){const t=await c.takePicture();this.pictureTaken.emit(t);return t}async resetCamera(){c.resetCamera()}async toggleCamera(){this.__toogleFacingMode()}onClickHandler(){this.__toogleFacingMode()}__toogleFacingMode(){this.facingMode=this.facingMode!=h.Front?h.Front:h.Rear;this.facingModeChanged.emit(this.facingMode)}componentWillMount(){}async componentDidRender(){c.initCamera(this.el,h.Front,this.drawImageCb)}async disconnectedCallback(){c.resetCamera()}render(){return s(e,{style:{height:this.height+"px",width:this.width+"px"}},s("slot",{name:"before"}),s("slot",null),s("slot",{name:"after"}))}get el(){return a(this)}};u.style=d;export{u as input_file_from_webcam};
//# sourceMappingURL=p-af8ff81c.entry.js.map